<#include "../../include/header.html">

<body>
	<script
		src="http://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
	<script type="text/javascript">
		var viewModel = kendo
				.observable({
					model : {},
					save : function(e) {

						var data = viewModel.model.toJSON();
						//转换启用状态
						data.enabledFlag = data.enabledFlag ? 'Y' : 'N';

						//确定是添加还是更新
						if (data.id) {
							data.__status = "update";
						} else {
							data.__status = "add";
						}

						var validator = $("#mainform").data("kendoValidator");
						if (validator.validate()) {
							//var data= viewModel.model.toJSON();
							$
									.ajax({
										type : 'POST',
										url : '${base.contextPath}/yh/cooperativeProject/submit',
										dataType : "json",
										contentType : "application/json",
										data : kendo.stringify([ data ]),
										success : function(data) {
											if (data.success == false) {
												kendo.ui.showErrorDialog({
													message : data.message
												});
											} else {
												window.parent.$("#dialog")
														.data("kendoWindow")
														.close();
											}
										}
									});
						}
					},
					closeWin : function(e) {
						window.parent.$("#dialog").data("kendoWindow").close();
					}
				});

		//var isedit = '${RequestParameters.employeeId!0}' == '';
		var id = '${RequestParameters.id!0}';

		if (id != 0) {

			$
					.ajax({
						url : '${base.contextPath}/hr/employee/query?employeeId=${RequestParameters.employeeId!0}',
						success : function(args) {
							var a0 = args.rows[0] || {};
							for ( var k in a0) {
								if (k === 'enabledFlag') {
									viewModel.model.set("enabledFlag",
											a0.enabledFlag == 'Y' ? true
													: false);
								} else {
									viewModel.model.set(k, a0[k]);
								}
							}
						}
					});
		}
	</script>



	<div class="container" style="margin-top: 20px;">
		<div id="page-content">
			<form id="mainform" class="form-horizontal" method="post"
				enctype="application/json;charset=UTF-8">

				<div class="row">
					<div class="form-group">
						<div class="col-sm-1">
							<img data-src="holder.js/140x140" class="img-rounded"
								alt="140x140"
								src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQwIiBoZWlnaHQ9IjE0MCIgdmlld0JveD0iMCAwIDE0MCAxNDAiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiPjxkZWZzLz48cmVjdCB3aWR0aD0iMTQwIiBoZWlnaHQ9IjE0MCIgZmlsbD0iI0VFRUVFRSIvPjxnPjx0ZXh0IHg9IjQ0LjA1NDY4NzUiIHk9IjcwIiBzdHlsZT0iZmlsbDojQUFBQUFBO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1mYW1pbHk6QXJpYWwsIEhlbHZldGljYSwgT3BlbiBTYW5zLCBzYW5zLXNlcmlmLCBtb25vc3BhY2U7Zm9udC1zaXplOjEwcHQ7ZG9taW5hbnQtYmFzZWxpbmU6Y2VudHJhbCI+MTQweDE0MDwvdGV4dD48L2c+PC9zdmc+"
								data-holder-rendered="true" style="width: 90px; height: 90px;">
						</div>
						<div class="col-sm-11" style="float: left; margin-top: 0px;">
							<div class="form-group">
								<label class="col-sm-2 control-label"><@spring.message
									"yh.cooperativeProject.projectname"/>:</label>
								<div class="col-sm-4">
									<input type="text" required style="width: 100%"
										name="projectname" data-bind="value:model.projectname"
										class="k-textbox">
								</div>
								<div class="col-sm-6">
									<span data-for="projectname" class=".k-invalid-msg"></span>
								</div>
							</div>

							<div class="form-group">
								<label class="col-sm-2 control-label"><@spring.message
									"yh.cooperativeProject.thumbnail"/>:</label>
								<div class="col-sm-4">
									<input type="text" required style="width: 100%"
										name="thumbnail" data-bind="value:model.thumbnail"
										class="k-textbox">
								</div>
								<div class="col-sm-6">
									<span data-for="thumbnail" class=".k-invalid-msg"></span>
								</div>
							</div>

							<div class="col-sm-12" style="margin-top: 40px;">
								<ul class="nav nav-tabs" id="mytab">
									<li class="active"><a href="#basic" data-toggle="tab"><@spring.message
											"yh.cooperativeProject.basicInfo"/></a></li>
									<li class=""><a href="#other" data-toggle="tab"><@spring.message
											"yh.cooperativeProject.otherInfo"/></a></li>
								</ul>
								<div id="myTabContent" class="tab-content">
									<div class="tab-pane fade in active" style="margin-top: 20px;"
										id="basic">

										<div class="form-group">
											<label class="col-sm-2 control-label"><@spring.message
												"yh.cooperativeProject.projectdateS"/>:</label>
											<div class="col-sm-4">
												<input style="width: 100%" name="joinDate"
													data-bind="value:model.projectdateS" class="datepicker">
											</div>
											<div class="col-sm-6">
												<span data-for="projectdateS" class=".k-invalid-msg"></span>
											</div>
										</div>

										<div class="form-group">
											<label class="col-sm-2 control-label"><@spring.message
												"yh.cooperativeProject.projectdateE"/>:</label>
											<div class="col-sm-4">
												<input style="width: 100%" name="joinDate"
													data-bind="value:model.projectdateE" class="datepicker">
											</div>
											<div class="col-sm-6">
												<span data-for="projectdateE" class=".k-invalid-msg"></span>
											</div>
										</div>

										<div class="form-group">
											<label class="col-sm-2 control-label"><@spring.message
												"yh.cooperativeProject.projectSite"/>:</label>
											<div class="col-sm-4">
												<input type="text" required style="width: 100%"
													name="employeeCode" data-bind="value:model.projectSite"
													class="k-textbox">
											</div>
											<div class="col-sm-6">
												<span data-for="projectSite" class=".k-invalid-msg"></span>
											</div>
										</div>

										<div class="form-group">
											<label class="col-sm-2 control-label"><@spring.message
												"yh.cooperativeProject.projectIntro"/>:</label>
											<div class="col-sm-4">
												<textarea name="customSql" id="customSql"
													data-role="maskedtextbox" type="text"
													style="width: 100%; cursor: text; color: #333;"
													data-bind="value:model.projectIntro" class="k-textbox"
													rows="5" cols="7"></textarea>
											</div>
											<div class="col-sm-6">
												<span data-for="projectIntro" class=".k-invalid-msg"></span>
											</div>
										</div>


										<div class="form-group">
											<label class="col-sm-2 control-label"><@spring.message
												"yh.cooperativeProject.projectContent"/>:</label>
											<div class="col-sm-4">
												<textarea name="customSql" id="customSql"
													data-role="maskedtextbox" type="text"
													style="width: 100%; cursor: text; color: #333;"
													data-bind="value:model.projectContent" class="k-textbox"
													rows="5" cols="7"></textarea>
											</div>
											<div class="col-sm-6">
												<span data-for="projectContent" class=".k-invalid-msg"></span>
											</div>
										</div>


									</div>
									<div class="tab-pane fade" style="margin-top: 20px;" id="other">
										<div style="margin-top: 20px;">
											<div class="form-group">
												<label class="col-sm-2 control-label"><@spring.message
													"yh.cooperativeProject.banner"/>:</label>
												<div class="col-sm-4">
													<input type="text" required style="width: 100%"
														name="banner" data-bind="value:model.banner"
														class="k-textbox">
												</div>
												<div class="col-sm-6">
													<span data-for="banner" class=".k-invalid-msg"></span>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>



					</div>
				</div>
				<div class="text-right"
					style="bottom: 20px; position: fixed; right: 85px; float: left; background: #fff;">
					<span class="btn btn-success" data-bind="click:save" type="submit"><@spring.message
						"hap.save"/></span> <span class="btn btn-success"
						data-bind="click:closeWin" type="button"><@spring.message
						"hap.cancel"/></span>
				</div>

			</form>
		</div>
	</div>

	<script type="text/javascript">
		kendo.bind($('#page-content'), viewModel);

		//验证
		$("#mainform").kendoValidator({
			messages : {
				required : "required"
			}
		});
		//日期
		$(".datepicker").kendoDatePicker({
			animation : false
		});
	</script>


</body>
</html>